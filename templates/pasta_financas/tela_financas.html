<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='pasta_financas/financas/import_todas_css.css') }}">
</head>


    <!-- BLOCO DE CONSULTA -->
    <section class="section_um_consulta">
        <form action=" {{ url_for('financas.inifinancas') }}" method="get">
            <div class="container_consulta">
                <div class="sub_container_consulta">
                    
                    <div class="label_input">
                        <label>DESCRI√á√ÉO:</label>
                        <input type="text" name="descricao" value="{{ request.args.get('descricao', '') }}">
                    </div>


                    <div class="label_input">
                        <label>Tipo:</label>
                        <select name="tipo">
                            <option value="" {% if request.args.get('tipo') == '' %}selected{% endif %}>Todos</option>
                            <option value="receita" {% if request.args.get('tipo') == 'receita' %}selected{% endif %}>Entrada</option>
                            <option value="despesa" {% if request.args.get('tipo') == 'despesa' %}selected{% endif %}>Despesa</option>
                        </select>
                    </div>

                    <div class="label_input">
                        <label>DATA INICIAL:</label>
                        <input type="date" name="data_inicio" value="{{ data_inicio }}">
                    </div>

                    <div class="label_input">
                        <label>DATA FINAL:</label>
                        <input type="date" name="data_final" value="{{ data_final }}">
                    </div>
                    
                </div>
                
                <div class="buttons">
                    <button type="submit" class="btn_consultar">Consultar</button>
                    <button type="reset" class="btn_limpar">Limpar</button>
                </div>

            </div>
        </form>
    </section>


    <!-- BOTOES TELAS -->
    <section class="section_botoes_telas">
        <!-- BOT√ÉO NOVA TRANSA√á√ÉO -->
        <div class="container_botoes_telas">
            <a href="{{ url_for('nova_transacao.initransacao') }}" class="btn_novo">
            ‚úö NOVO
            </a>

            <a href="{{ url_for('dashboard.inidashboard') }}" class="btn_dashboard" target="_blank">DASHBOARD</a>

            <a href="{{ url_for('pos_login.iniposlogin') }}" class="btn_voltar">VOLTAR</a>
        </div>
    </section>
    
    <!-- SE√á√ÉO TABELA DE TRANSA√á√ïES -->
    <section class="section_tabela">
        <div class="container_tabela">
            <table class="tabela_transacoes">
                <thead>
                    <tr>
                        <th>VALOR</th>
                        <th>DESCRI√á√ÉO</th>
                        <th>STATUS</th>
                        <th>CATEGORIA</th>
                        <th>DATA CRIA√á√ÉO</th>
                        <th>DATA VENCIMENTO</th>
                        <th>TIPO</th>
                        <th>A√á√ïES</th>
                    </tr>
                </thead>
                <tbody>
                    {% for transacao in transacoes %}
                    <tr>
                        <!-- VALOR TOTAL -->
                        <td class="{% if transacao[1] == 'receita' %}valor_positivo{% else %}valor_negativo{% endif %}">
                            R$ {{ "%.2f"|format(transacao[2]) }}
                        </td>

                        <!-- descricao -->
                        <td>{{ transacao[3] }}</td>  

                        <!-- status -->
                        <td>
                            {% if transacao[1] == 'despesa' %}
                                {% if transacao[6] == 'aberto' %}
                                    <span style="background: #ff4444; color: white; padding: 3px 8px; border-radius: 10px;">ABERTO</span>
                                {% elif transacao[6] == 'quitado' %}
                                    <span style="background: #00C851; color: white; padding: 3px 8px; border-radius: 10px;">QUITADO</span>
                                {% endif %}
                            {% endif %}
                        </td>

                        <!-- categoria -->
                        <td>{{ transacao[5] or "Geral" }}</td>

                        <!-- data emiss√£o -->
                        <td>{{ transacao[4] }}</td>

                        <!-- data vencimento -->
                        <td>{{ transacao[7] }}</td>

                        <!-- tipo -->
                        <td>
                            {% if transacao[1] == 'receita' %}
                                üìà Entrada
                            {% else %}
                                üìâ Despesa
                            {% endif %}
                        </td>

                        <!-- a√ß√µes -->
                        <td>
                            <a href="{{ url_for('edit_transacoes.inieditar', transacao_id=transacao[0]) }}" title="Editar">‚úèÔ∏è</a>

                            <a href="{{ url_for('deletar_transacao.inideletar', transacao_id=transacao[0]) }}" title="Excluir"
                            onclick="return confirm('Tem certeza que deseja excluir est√° transa√ß√£o?')">‚ùå</a>

                            {% if transacao[1] == 'despesa' and transacao[6] == 'aberto' %}
                                <a href="{{ url_for('quitar_transacao.iniquitacao', transacao_id=transacao[0]) }}" 
                                style="background: #00C851; color: white; padding: 3px 8px; text-decoration: none; border-radius: 5px; margin-left: 5px;"
                                title="Quitar despesa"
                                onclick="return confirm('Quitar esta despesa?')">
                                ‚úÖ Quitar
                                </a>
                            {% endif %}
                            
                        </td>
                    </tr>


                    {% else %}
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 20px;">
                            üì≠ Nenhuma transa√ß√£o cadastrada.
                            <br>
                        </td>
                    </tr>
                    {% endfor %}

                </tbody>
            </table>
        </div>
    </section>




</html>